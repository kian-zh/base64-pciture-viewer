(()=>{"use strict";var e={729:function(e,s,r){var n=r(848),l=r(540),a=r(338);let t=e=>{try{let s=atob(e.substring(0,50)),r=new Uint8Array(s.length);for(let e=0;e<s.length;e++)r[e]=s.charCodeAt(e);if(137===r[0]&&80===r[1]&&78===r[2]&&71===r[3])return"png";if(255===r[0]&&216===r[1]&&255===r[2])return"jpg";if(71===r[0]&&73===r[1]&&70===r[2]&&56===r[3])return"gif";if(82===r[0]&&73===r[1]&&70===r[2]&&70===r[3])return"webp";let n=new TextDecoder().decode(r);if(n.includes("<svg")||n.includes("<?xml"))return"svg"}catch(e){console.warn("检测图片格式时出错:",e)}return null},i=e=>{let{imageData:s}=e,[r,a]=(0,l.useState)(!1),[t,i]=(0,l.useState)(!1),c=(0,l.useRef)(null),o=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},d=e=>({png:"PNG",jpg:"JPEG",jpeg:"JPEG",svg:"SVG",gif:"GIF",webp:"WebP"})[null==e?void 0:e.toLowerCase()]||(null==e?void 0:e.toUpperCase())||"未知",u=()=>!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.documentElement&&(document.documentElement.requestFullscreen||document.documentElement.webkitRequestFullscreen||document.documentElement.mozRequestFullScreen||document.documentElement.msRequestFullscreen)),m=async()=>{if(a(!0),await new Promise(e=>requestAnimationFrame(e)),c.current)try{c.current.requestFullscreen?await c.current.requestFullscreen():c.current.webkitRequestFullscreen?await c.current.webkitRequestFullscreen():c.current.mozRequestFullScreen?await c.current.mozRequestFullScreen():c.current.msRequestFullscreen&&await c.current.msRequestFullscreen()}catch(e){console.warn("无法进入全屏模式:",e)}},h=async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(e){console.warn("退出全屏时发生错误:",e)}a(!1)},p=()=>{r?h():m()};return((0,l.useEffect)(()=>{let e=()=>{!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)&&r&&a(!1)},s=e=>{"Escape"===e.key&&r&&h()};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),document.addEventListener("keydown",s),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e),document.removeEventListener("keydown",s)}},[r]),t)?(0,n.jsx)("div",{className:"image-preview error",children:(0,n.jsxs)("div",{className:"error-content",children:[(0,n.jsx)("div",{className:"error-icon",children:"!"}),(0,n.jsx)("h3",{children:"图片加载失败"}),(0,n.jsx)("p",{children:"无法显示此图片，可能是格式不受支持或数据损坏"})]})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"image-preview",children:[(0,n.jsxs)("div",{className:"image-info",children:[(0,n.jsxs)("div",{className:"info-row",children:[(0,n.jsx)("span",{className:"label",children:"格式："}),(0,n.jsx)("span",{className:"value format-badge",children:d(s.format)})]}),(0,n.jsxs)("div",{className:"info-row",children:[(0,n.jsx)("span",{className:"label",children:"大小："}),(0,n.jsx)("span",{className:"value",children:o(s.size)})]})]}),(0,n.jsx)("div",{className:"image-container",children:(0,n.jsx)("img",{src:s.src,alt:"Base64 图片预览",className:"preview-image",onError:()=>{i(!0)},onClick:p,loading:"lazy"})}),(0,n.jsxs)("div",{className:"image-actions",children:[(0,n.jsx)("button",{className:"btn btn-secondary",onClick:()=>{let e=document.createElement("a");e.href=s.src,e.download=`image.${s.format}`,e.click()},children:"下载图片"}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:p,disabled:!u(),title:u()?r?"退出全屏":"全屏查看":"您的浏览器不支持全屏功能",children:r?"退出全屏":"全屏查看"})]})]}),r&&(0,n.jsx)("div",{className:"fullscreen-overlay",onClick:e=>{e.target===e.currentTarget&&h()},ref:c,children:(0,n.jsxs)("div",{className:"fullscreen-container",children:[(0,n.jsx)("button",{className:"close-fullscreen",onClick:h,title:"退出全屏 (ESC)",children:"\xd7"}),(0,n.jsx)("img",{src:s.src,alt:"全屏图片预览",className:"fullscreen-image",onClick:e=>e.stopPropagation()}),(0,n.jsxs)("div",{className:"fullscreen-info",children:[(0,n.jsx)("span",{className:"fullscreen-format",children:d(s.format)}),(0,n.jsx)("span",{className:"fullscreen-size",children:o(s.size)})]})]})})]})},c=e=>{let{onFileUpload:s}=e,[r,a]=(0,l.useState)(!1),t=(0,l.useCallback)(e=>{e.preventDefault(),a(!0)},[]),i=(0,l.useCallback)(e=>{e.preventDefault(),a(!1)},[]),c=(0,l.useCallback)(e=>{e.preventDefault(),a(!1);let r=Array.from(e.dataTransfer.files).find(e=>e.type.startsWith("image/"));r?s(r):alert("请选择图片文件（PNG、JPG、SVG 等格式）")},[s]),o=(0,l.useCallback)(e=>{let r=e.target.files[0];r&&(r.type.startsWith("image/")?s(r):alert("请选择图片文件（PNG、JPG、SVG 等格式）")),e.target.value=""},[s]);return(0,n.jsxs)("div",{className:"file-upload",children:[(0,n.jsx)("div",{className:"upload-divider",children:(0,n.jsx)("span",{children:"或者"})}),(0,n.jsxs)("div",{className:`upload-zone ${r?"drag-over":""}`,onDragOver:t,onDragLeave:i,onDrop:c,children:[(0,n.jsxs)("div",{className:"upload-content",children:[(0,n.jsx)("div",{className:"upload-icon",children:"文件"}),(0,n.jsx)("h3",{children:"拖拽图片文件到此处"}),(0,n.jsx)("p",{children:"或者点击下方按钮选择文件"}),(0,n.jsx)("small",{children:"支持 PNG、JPG、JPEG、SVG、GIF、WebP 格式"})]}),(0,n.jsxs)("label",{className:"upload-button",children:[(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:o,className:"file-input"}),(0,n.jsx)("span",{className:"btn btn-outline",children:"选择图片文件"})]})]})]})},o=()=>{let[e,s]=(0,l.useState)(""),[r,a]=(0,l.useState)(null),[o,d]=(0,l.useState)(""),[u,m]=(0,l.useState)(!1),h=(0,l.useCallback)(e=>{if(s(e),d(""),!e.trim())return void a(null);m(!0),setTimeout(()=>{try{let s=(e=>{let s,r;if(!e||"string"!=typeof e)return{isValid:!1,error:"请输入有效的 Base64 字符串"};let n=e.trim();if(!n)return{isValid:!1,error:"Base64 字符串不能为空"};if(/^data:image\/(png|jpe?g|gif|svg\+xml|webp|bmp|tiff?);base64,/i.test(n))r=n,s=n.split(",")[1];else{let e=t(s=n);if(!e)return{isValid:!1,error:"无法识别图片格式，请确保是有效的图片 Base64 数据"};let l={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",svg:"image/svg+xml",webp:"image/webp",bmp:"image/bmp",tiff:"image/tiff",tif:"image/tiff"}[e.toLowerCase()]||"image/png";r=`data:${l};base64,${s}`}return(e=>{try{if(!/^[A-Za-z0-9+/]*={0,2}$/.test(e))return!1;return atob(e),!0}catch(e){return!1}})(s)?{isValid:!0,dataUrl:r,base64Data:s}:{isValid:!1,error:"无效的 Base64 格式"}})(e);if(s.isValid){let r=(e=>{if(!e)return null;let s=e.match(/^data:image\/([\w+]+);base64,/i);if(s){let e=s[1].toLowerCase();return"svg+xml"===e?e="svg":"jpeg"===e&&(e="jpg"),e}return t(e)})(e);a({src:s.dataUrl,format:r,size:e.length}),d("")}else d(s.error),a(null)}catch(e){d("解析 Base64 数据时发生错误"),a(null)}finally{m(!1)}},100)},[]),p=(0,l.useCallback)(e=>{m(!0);let r=new FileReader;r.onload=e=>{let r=e.target.result;s(r),h(r)},r.onerror=()=>{d("读取文件时发生错误"),m(!1)},r.readAsDataURL(e)},[h]),g=(0,l.useCallback)(()=>{s(""),a(null),d("")},[]),v=(0,l.useCallback)(()=>{r&&navigator.clipboard.writeText(e).then(()=>{alert("Base64 数据已复制到剪贴板")}).catch(()=>{alert("复制失败，请手动选择文本复制")})},[e,r]);return(0,n.jsxs)("div",{className:"base64-image-viewer",children:[(0,n.jsxs)("div",{className:"viewer-section",children:[(0,n.jsx)("h2",{children:"输入 Base64 数据"}),(0,n.jsxs)("div",{className:"input-section",children:[(0,n.jsx)("textarea",{className:"base64-input",placeholder:"请粘贴 Base64 编码的图片数据...",value:e,onChange:e=>h(e.target.value),rows:6}),(0,n.jsxs)("div",{className:"input-actions",children:[(0,n.jsx)("button",{className:"btn btn-secondary",onClick:g,disabled:!e,children:"清空"}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:v,disabled:!r,children:"复制"})]})]}),(0,n.jsx)(c,{onFileUpload:p}),u&&(0,n.jsxs)("div",{className:"loading",children:[(0,n.jsx)("div",{className:"loading-spinner"}),(0,n.jsx)("span",{children:"正在处理..."})]}),o&&(0,n.jsxs)("div",{className:"error-message",children:[(0,n.jsx)("strong",{children:"错误："}),o]})]}),(0,n.jsxs)("div",{className:"preview-section",children:[(0,n.jsx)("h2",{children:"图片预览"}),r?(0,n.jsx)(i,{imageData:r}):(0,n.jsxs)("div",{className:"empty-preview",children:[(0,n.jsx)("div",{className:"empty-icon",children:"图片"}),(0,n.jsx)("p",{children:"请输入有效的 Base64 图片数据或上传图片文件"}),(0,n.jsx)("small",{children:"支持 PNG、JPG、JPEG、SVG 格式"})]})]})]})};a.createRoot(document.getElementById("root")).render((0,n.jsx)(l.StrictMode,{children:(0,n.jsx)(function(){return(0,n.jsxs)("div",{className:"App",children:[(0,n.jsxs)("header",{className:"App-header",children:[(0,n.jsx)("h1",{children:"Base64 图片预览器"}),(0,n.jsx)("p",{children:"支持 PNG、JPG、SVG 格式的 Base64 图片预览"})]}),(0,n.jsx)("main",{className:"App-main",children:(0,n.jsx)(o,{})}),(0,n.jsx)("footer",{className:"App-footer",children:(0,n.jsx)("p",{children:"\xa9 2024 Base64 图片预览器 - 由 React 驱动"})})]})},{})}))}},s={};function r(n){var l=s[n];if(void 0!==l)return l.exports;var a=s[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.m=e,r.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{var e=[];r.O=(s,n,l,a)=>{if(n){a=a||0;for(var t=e.length;t>0&&e[t-1][2]>a;t--)e[t]=e[t-1];e[t]=[n,l,a];return}for(var i=1/0,t=0;t<e.length;t++){for(var[n,l,a]=e[t],c=!0,o=0;o<n.length;o++)(!1&a||i>=a)&&Object.keys(r.O).every(e=>r.O[e](n[o]))?n.splice(o--,1):(c=!1,a<i&&(i=a));if(c){e.splice(t--,1);var d=l();void 0!==d&&(s=d)}}return s}})(),(()=>{var e={410:0};r.O.j=s=>0===e[s];var s=(s,n)=>{var l,a,[t,i,c]=n,o=0;if(t.some(s=>0!==e[s])){for(l in i)r.o(i,l)&&(r.m[l]=i[l]);if(c)var d=c(r)}for(s&&s(n);o<t.length;o++)a=t[o],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(d)},n=self.webpackChunkbase64_picture_viewer=self.webpackChunkbase64_picture_viewer||[];n.forEach(s.bind(null,0)),n.push=s.bind(null,n.push.bind(n))})();var n=r.O(void 0,["783"],function(){return r(729)});n=r.O(n)})();